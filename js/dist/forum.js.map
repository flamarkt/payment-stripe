{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@flamarkt/balance/./node_modules/@stripe/stripe-js/dist/pure.js","webpack://@flamarkt/balance/./node_modules/@stripe/stripe-js/pure.js","webpack://@flamarkt/balance/./node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://@flamarkt/balance/./node_modules/@babel/runtime/helpers/typeof.js","webpack://@flamarkt/balance/./node_modules/@babel/runtime/regenerator/index.js","webpack://@flamarkt/balance/webpack/bootstrap","webpack://@flamarkt/balance/webpack/runtime/compat get default export","webpack://@flamarkt/balance/webpack/runtime/define property getters","webpack://@flamarkt/balance/webpack/runtime/hasOwnProperty shorthand","webpack://@flamarkt/balance/webpack/runtime/make namespace object","webpack://@flamarkt/balance/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://@flamarkt/balance/external root \"flarum.core.compat['forum/app']\"","webpack://@flamarkt/balance/external root \"flarum.core.compat['common/extend']\"","webpack://@flamarkt/balance/external root \"((flarum.extensions['flamarkt-core']||{})['forum']||{})['layouts/CartLayout']\"","webpack://@flamarkt/balance/external root \"((flarum.extensions['flamarkt-core']||{})['forum']||{})['components/OrderFactPayment']\"","webpack://@flamarkt/balance/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@flamarkt/balance/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flamarkt/balance/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@flamarkt/balance/./src/forum/components/IframeModal.ts","webpack://@flamarkt/balance/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flamarkt/balance/./src/forum/compat.ts","webpack://@flamarkt/balance/./src/forum/loadStripe.ts","webpack://@flamarkt/balance/./src/forum/index.ts"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nvar V3_URL = 'https://js.stripe.com/v3';\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(V3_URL, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!V3_URL_REGEX.test(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(V3_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"1.35.0\",\n    startTime: startTime\n  });\n};\n\nvar stripePromise = null;\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise !== null) {\n    return stripePromise;\n  }\n\n  stripePromise = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      }\n\n      script.addEventListener('load', function () {\n        if (window.Stripe) {\n          resolve(window.Stripe);\n        } else {\n          reject(new Error('Stripe.js not available'));\n        }\n      });\n      script.addEventListener('error', function () {\n        reject(new Error('Failed to load Stripe.js'));\n      });\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  });\n  return stripePromise;\n};\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n}; // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\nvar validateLoadParams = function validateLoadParams(params) {\n  var errorMessage = \"invalid load parameters; expected object of shape\\n\\n    {advancedFraudSignals: boolean}\\n\\nbut received\\n\\n    \".concat(JSON.stringify(params), \"\\n\");\n\n  if (params === null || _typeof(params) !== 'object') {\n    throw new Error(errorMessage);\n  }\n\n  if (Object.keys(params).length === 1 && typeof params.advancedFraudSignals === 'boolean') {\n    return params;\n  }\n\n  throw new Error(errorMessage);\n};\n\nvar loadParams;\nvar loadStripeCalled = false;\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadStripeCalled = true;\n  var startTime = Date.now();\n  return loadScript(loadParams).then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\nloadStripe.setLoadParameters = function (params) {\n  if (loadStripeCalled) {\n    throw new Error('You cannot change load parameters after calling loadStripe');\n  }\n\n  loadParams = validateLoadParams(params);\n};\n\nexports.loadStripe = loadStripe;\n","module.exports = require('./dist/pure.js');\n","var _typeof = require(\"./typeof.js\")[\"default\"];\n\nfunction _regeneratorRuntime() {\n  \"use strict\";\n  /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return exports;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var exports = {},\n      Op = Object.prototype,\n      hasOwn = Op.hasOwnProperty,\n      $Symbol = \"function\" == typeof Symbol ? Symbol : {},\n      iteratorSymbol = $Symbol.iterator || \"@@iterator\",\n      asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\",\n      toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    return Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), obj[key];\n  }\n\n  try {\n    define({}, \"\");\n  } catch (err) {\n    define = function define(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,\n        generator = Object.create(protoGenerator.prototype),\n        context = new Context(tryLocsList || []);\n    return generator._invoke = function (innerFn, self, context) {\n      var state = \"suspendedStart\";\n      return function (method, arg) {\n        if (\"executing\" === state) throw new Error(\"Generator is already running\");\n\n        if (\"completed\" === state) {\n          if (\"throw\" === method) throw arg;\n          return doneResult();\n        }\n\n        for (context.method = method, context.arg = arg;;) {\n          var delegate = context.delegate;\n\n          if (delegate) {\n            var delegateResult = maybeInvokeDelegate(delegate, context);\n\n            if (delegateResult) {\n              if (delegateResult === ContinueSentinel) continue;\n              return delegateResult;\n            }\n          }\n\n          if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) {\n            if (\"suspendedStart\" === state) throw state = \"completed\", context.arg;\n            context.dispatchException(context.arg);\n          } else \"return\" === context.method && context.abrupt(\"return\", context.arg);\n          state = \"executing\";\n          var record = tryCatch(innerFn, self, context);\n\n          if (\"normal\" === record.type) {\n            if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue;\n            return {\n              value: record.arg,\n              done: context.done\n            };\n          }\n\n          \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg);\n        }\n      };\n    }(innerFn, self, context), generator;\n  }\n\n  function tryCatch(fn, obj, arg) {\n    try {\n      return {\n        type: \"normal\",\n        arg: fn.call(obj, arg)\n      };\n    } catch (err) {\n      return {\n        type: \"throw\",\n        arg: err\n      };\n    }\n  }\n\n  exports.wrap = wrap;\n  var ContinueSentinel = {};\n\n  function Generator() {}\n\n  function GeneratorFunction() {}\n\n  function GeneratorFunctionPrototype() {}\n\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n  var getProto = Object.getPrototypeOf,\n      NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function (method) {\n      define(prototype, method, function (arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n\n      if (\"throw\" !== record.type) {\n        var result = record.arg,\n            value = result.value;\n        return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        }) : PromiseImpl.resolve(value).then(function (unwrapped) {\n          result.value = unwrapped, resolve(result);\n        }, function (error) {\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n\n      reject(record.arg);\n    }\n\n    var previousPromise;\n\n    this._invoke = function (method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function (resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n    };\n  }\n\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n\n    if (undefined === method) {\n      if (context.delegate = null, \"throw\" === context.method) {\n        if (delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method)) return ContinueSentinel;\n        context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n    if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel;\n    var info = record.arg;\n    return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel);\n  }\n\n  function pushTryEntry(locs) {\n    var entry = {\n      tryLoc: locs[0]\n    };\n    1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\", delete record.arg, entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);\n  }\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) return iteratorMethod.call(iterable);\n      if (\"function\" == typeof iterable.next) return iterable;\n\n      if (!isNaN(iterable.length)) {\n        var i = -1,\n            next = function next() {\n          for (; ++i < iterable.length;) {\n            if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;\n          }\n\n          return next.value = undefined, next.done = !0, next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    return {\n      next: doneResult\n    };\n  }\n\n  function doneResult() {\n    return {\n      value: undefined,\n      done: !0\n    };\n  }\n\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, define(Gp, \"constructor\", GeneratorFunctionPrototype), define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) {\n    var ctor = \"function\" == typeof genFun && genFun.constructor;\n    return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name));\n  }, exports.mark = function (genFun) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun;\n  }, exports.awrap = function (arg) {\n    return {\n      __await: arg\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    void 0 === PromiseImpl && (PromiseImpl = Promise);\n    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n    return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {\n      return result.done ? result.value : iter.next();\n    });\n  }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () {\n    return this;\n  }), define(Gp, \"toString\", function () {\n    return \"[object Generator]\";\n  }), exports.keys = function (object) {\n    var keys = [];\n\n    for (var key in object) {\n      keys.push(key);\n    }\n\n    return keys.reverse(), function next() {\n      for (; keys.length;) {\n        var key = keys.pop();\n        if (key in object) return next.value = key, next.done = !1, next;\n      }\n\n      return next.done = !0, next;\n    };\n  }, exports.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(skipTempReset) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) {\n        \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);\n      }\n    },\n    stop: function stop() {\n      this.done = !0;\n      var rootRecord = this.tryEntries[0].completion;\n      if (\"throw\" === rootRecord.type) throw rootRecord.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(exception) {\n      if (this.done) throw exception;\n      var context = this;\n\n      function handle(loc, caught) {\n        return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i],\n            record = entry.completion;\n        if (\"root\" === entry.tryLoc) return handle(\"end\");\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\"),\n              hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n          } else {\n            if (!hasFinally) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n\n        if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);\n      var record = finallyEntry ? finallyEntry.completion : {};\n      return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);\n    },\n    complete: function complete(record, afterLoc) {\n      if (\"throw\" === record.type) throw record.arg;\n      return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;\n    },\n    finish: function finish(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;\n      }\n    },\n    \"catch\": function _catch(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n\n          if (\"throw\" === record.type) {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n\n          return thrown;\n        }\n      }\n\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n      return this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel;\n    }\n  }, exports;\n}\n\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(obj);\n}\n\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['forum']||{})['layouts/CartLayout'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['forum']||{})['components/OrderFactPayment'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","import Modal, {IInternalModalAttrs} from 'flarum/common/components/Modal';\n\ninterface IframeModalAttrs extends IInternalModalAttrs {\n    url: string\n}\n\nexport default class IframeModal extends Modal<IframeModalAttrs> {\n    className(): string {\n        return 'FlamarktStripePaymentModal';\n    }\n\n    title() {\n        return '';\n    }\n\n    content() {\n        return m('iframe', {\n            src: this.attrs.url,\n            width: 600,\n            height: 400,\n        });\n    }\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import IframeModal from './components/IframeModal';\n\nexport const forum = {\n    'components/IframeModal': IframeModal,\n}\n","import {Stripe} from '@stripe/stripe-js';\nimport {loadStripe} from '@stripe/stripe-js/pure';\nimport app from 'flarum/forum/app';\n\n// confirmCardPayment requires the same instance of Stripe.js to be used between element creation and confirmation, so we'll store it here\nlet instance: Stripe | null = null;\n\nexport default async function (): Promise<Stripe> {\n    if (!instance) {\n        instance = await loadStripe(app.forum.attribute('flamarktStripePublishableKey'));\n\n        // Not sure why loadStripe is type-hinted as possible null while the example don't mention it\n        if (!instance) {\n            throw new Error('Stripe.js failed to load');\n        }\n    }\n\n    return instance;\n}\n","import {PaymentIntentResult, StripeCardElement, StripeError} from '@stripe/stripe-js';\nimport app from 'flarum/forum/app';\nimport {extend, override} from 'flarum/common/extend';\nimport CartLayout from 'flamarkt/core/forum/layouts/CartLayout';\nimport OrderFactPayment from 'flamarkt/core/forum/components/OrderFactPayment';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Order from 'flamarkt/core/common/models/Order';\nimport {forum} from './compat';\nimport IframeModal from './components/IframeModal';\nimport loadStripe from './loadStripe';\n\nexport {\n    forum,\n};\n\napp.initializers.add('flamarkt-payment-stripe', () => {\n    extend(CartLayout.prototype, 'oninit', function () {\n        this.payWithStripe = false;\n        this.stripeClientSecret = null;\n        this.stripePaymentIntentSucceeded = false;\n        this.stripePaymentElements = null;\n        this.stripePaymentElement = null;\n    });\n\n    extend(CartLayout.prototype, 'oncreate', function () {\n        this.stripeMessageEventListener = async (event: MessageEvent) => {\n            if (event.data === '3DS-authentication-complete' && this.stripeClientSecret) {\n                app.modal.close();\n\n                const response = await (await loadStripe()).retrievePaymentIntent(this.stripeClientSecret);\n\n                this.stripeCompleteIntent(response, true);\n            }\n        };\n\n        window.addEventListener('message', this.stripeMessageEventListener, false);\n    });\n\n\n    extend(CartLayout.prototype, 'onremove', function () {\n        window.removeEventListener('message', this.stripeMessageEventListener);\n    });\n\n    extend(CartLayout.prototype, 'sectionPayment', function (items) {\n        items.add('stripe', m('.Form-group', [\n            m('label', [\n                m('input', {\n                    type: 'checkbox',\n                    checked: this.payWithStripe,\n                    onchange: () => {\n                        this.payWithStripe = !this.payWithStripe;\n\n                        if (this.payWithStripe && !this.stripeClientSecret && !app.forum.attribute('flamarktStripeHostedCheckout')) {\n                            app.request<any>({\n                                method: 'GET',\n                                url: app.forum.attribute('apiUrl') + '/flamarkt/stripe-payment-intent',\n                            }).then(async response => {\n                                this.stripeClientSecret = response.client_secret;\n                                this.stripePaymentElements = (await loadStripe()).elements({clientSecret: this.stripeClientSecret!});\n                                if (app.forum.attribute('flamarktStripeCardOnly')) {\n                                    this.stripePaymentElement = this.stripePaymentElements.create('card');\n                                } else {\n                                    this.stripePaymentElement = this.stripePaymentElements.create('payment');\n                                }\n                                m.redraw();\n                            });\n                        }\n                    },\n                    disabled: this.submitting || !this.attrs.cart!.canCheckout(),\n                }),\n                ' Pay with Stripe',\n            ]),\n            this.payWithStripe && !app.forum.attribute('flamarktStripeHostedCheckout') ? [\n                this.stripePaymentElement ? m('#stripe-payment-element', {\n                    oncreate: () => {\n                        this.stripePaymentElement!.mount('#stripe-payment-element');\n                    },\n                }) : LoadingIndicator.component(),\n            ] : null,\n        ]));\n    });\n\n    extend(CartLayout.prototype, 'data', function (data: any) {\n        data.payWithStripe = this.payWithStripe;\n    });\n\n    CartLayout.prototype.stripeCompleteIntent = async function (this: CartLayout, response: PaymentIntentResult | { error: StripeError }, noRecursion: boolean = false) {\n        // When using confirmCardPayment, there might be no errors\n        // This will also be used by confirmPayment when a redirect isn't required\n        if (!response.error) {\n            if (response.paymentIntent && response.paymentIntent.next_action && response.paymentIntent.next_action.redirect_to_url) {\n                app.modal.show(IframeModal, {\n                    url: response.paymentIntent.next_action.redirect_to_url.url,\n                });\n\n                return;\n            }\n\n            this.submitting = true;\n            m.redraw();\n\n            app.store.createRecord<Order>('flamarkt-orders')\n                .save(this.data() as any)\n                .then(this.afterSuccessfulSubmit.bind(this))\n                .catch(this.afterFailedSubmit.bind(this));\n\n            return;\n        }\n\n        const {error} = response;\n\n        // This error can happen if we are back on the page after a failed iframe redirect\n        // We'll check the state of the intent again and finish the submission if necessary\n        // The noRecursion parameter prevents an infinite loop\n        if (!noRecursion && error.type === 'invalid_request_error' && error.code === 'payment_intent_unexpected_state') {\n            const response = await (await loadStripe()).retrievePaymentIntent(this.stripeClientSecret!);\n\n            this.stripeCompleteIntent(response, true);\n\n            return;\n        }\n\n        // This code should only execute if there was an error (user is already redirected otherwise)\n        if (error.type === 'card_error' || error.type === 'validation_error') {\n            alert(error.message);\n        } else {\n            alert('An unexpected Stripe payment confirmation error occurred.');\n        }\n\n        this.submitting = false;\n        m.redraw();\n    }\n\n    override(CartLayout.prototype, 'onsubmit', function (original: any, event: Event) {\n        if (this.payWithStripe && app.forum.attribute('flamarktStripeHostedCheckout')) {\n            event.preventDefault();\n\n            const form = document.createElement('form');\n            form.method = 'POST';\n            form.action = app.forum.attribute('baseUrl') + '/flamarkt/stripe-checkout';\n            const field = document.createElement('input');\n            field.type = 'hidden';\n            field.name = 'csrfToken';\n            field.value = app.session.csrfToken!;\n            form.appendChild(field);\n            document.body.appendChild(form);\n            form.submit();\n\n            return;\n        }\n\n        if (!this.payWithStripe || this.stripePaymentIntentSucceeded) {\n            return original(event);\n        }\n\n        event.preventDefault();\n\n        if (!this.stripeClientSecret) {\n            alert('There was an issue retrieving the Stripe payment intent token');\n            return;\n        }\n\n        this.submitting = true;\n\n        (async () => {\n            const stripe = await loadStripe();\n\n            let response!: PaymentIntentResult | { error: StripeError };\n\n            try {\n                if (app.forum.attribute('flamarktStripeCardOnly')) {\n                    response = await stripe.confirmCardPayment(this.stripeClientSecret!, {\n                        payment_method: {card: this.stripePaymentElement as StripeCardElement},\n                        return_url: app.forum.attribute('baseUrl') + '/flamarkt/stripe-iframe-complete',\n                    }, {handleActions: false});\n                } else {\n                    response = await stripe.confirmPayment({\n                        elements: this.stripePaymentElements!,\n                        confirmParams: {\n                            return_url: app.forum.attribute('baseUrl') + '/flamarkt/stripe-redirect',\n                        },\n                        redirect: app.forum.attribute('flamarktStripeAlwaysRedirect') ? 'always' : 'if_required',\n                    });\n                }\n            } catch (error) {\n                // TODO: better message? what might happen here?\n                alert(error);\n\n                throw error;\n            }\n\n            this.stripeCompleteIntent(response);\n        })();\n    });\n\n    override(OrderFactPayment.prototype, 'label', function (original) {\n        if (this.attrs.payment.method() === 'stripe') {\n            // TODO: option to use icon\n            return 'Stripe';\n        }\n\n        return original();\n    });\n});\n"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","loadParams","V3_URL","V3_URL_REGEX","EXISTING_SCRIPT_MESSAGE","stripePromise","loadScript","params","Promise","resolve","reject","window","Stripe","console","warn","script","scripts","document","querySelectorAll","concat","i","length","test","src","findScript","queryString","advancedFraudSignals","createElement","headOrBody","head","body","Error","appendChild","injectScript","addEventListener","error","initStripe","maybeStripe","args","startTime","stripe","apply","undefined","_registerWrapper","name","version","registerWrapper","loadStripeCalled","loadStripe","_len","arguments","Array","_key","Date","now","then","setLoadParameters","errorMessage","JSON","stringify","Object","keys","validateLoadParams","exports","module","require","_regeneratorRuntime","__esModule","Op","hasOwn","hasOwnProperty","$Symbol","iteratorSymbol","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","key","value","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","_invoke","state","method","arg","done","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","type","fn","call","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","AsyncIterator","PromiseImpl","invoke","result","__await","unwrapped","previousPromise","callInvokeWithMethodAndArg","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","doneResult","displayName","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","async","iter","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","d","a","definition","o","get","prop","r","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","flarum","core","compat","extensions","_setPrototypeOf","p","bind","IframeModal","subClass","superClass","className","title","content","m","attrs","url","width","height","Modal","forum","instance","app","extend","CartLayout","payWithStripe","stripeClientSecret","stripePaymentIntentSucceeded","stripePaymentElements","stripePaymentElement","stripeMessageEventListener","event","data","retrievePaymentIntent","response","stripeCompleteIntent","removeEventListener","items","add","checked","onchange","client_secret","elements","clientSecret","redraw","disabled","submitting","cart","canCheckout","oncreate","mount","LoadingIndicator","noRecursion","paymentIntent","next_action","redirect_to_url","save","afterSuccessfulSubmit","afterFailedSubmit","code","alert","message","override","original","preventDefault","form","action","field","submit","confirmCardPayment","payment_method","card","return_url","handleActions","confirmPayment","confirmParams","redirect","OrderFactPayment","payment"],"sourceRoot":""}