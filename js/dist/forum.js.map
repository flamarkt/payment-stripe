{"version":3,"file":"forum.js","mappings":";sCAIA,SAASA,EAAQC,GAaf,OATED,EADoB,mBAAXE,QAAoD,iBAApBA,OAAOC,SACtC,SAAUF,GAClB,cAAcA,CACf,EAES,SAAUA,GAClB,OAAOA,GAAyB,mBAAXC,QAAyBD,EAAIG,cAAgBF,QAAUD,IAAQC,OAAOG,UAAY,gBAAkBJ,CAC1H,EAGID,EAAQC,EAChB,CAED,IAuHIK,EAvHAC,EAAS,2BACTC,EAAe,4CACfC,EAA0B,mJA2C1BC,EAAgB,KAChBC,EAAa,SAAoBC,GAEnC,OAAsB,OAAlBF,IAIJA,EAAgB,IAAIG,SAAQ,SAAUC,EAASC,GAC7C,GAAsB,oBAAXC,OAWX,GAJIA,OAAOC,QAAUL,GACnBM,QAAQC,KAAKV,GAGXO,OAAOC,OACTH,EAAQE,OAAOC,aAIjB,IACE,IAAIG,EAnEO,WAGf,IAFA,IAAIC,EAAUC,SAASC,iBAAiB,gBAAiBC,OAAOjB,EAAQ,OAE/DkB,EAAI,EAAGA,EAAIJ,EAAQK,OAAQD,IAAK,CACvC,IAAIL,EAASC,EAAQI,GAErB,GAAKjB,EAAamB,KAAKP,EAAOQ,KAI9B,OAAOR,CACR,CAED,OAAO,IACR,CAqDkBS,GAETT,GAAUR,EACZM,QAAQC,KAAKV,GACHW,IACVA,EAxDW,SAAsBR,GACvC,IAAIkB,EAAclB,IAAWA,EAAOmB,qBAAuB,8BAAgC,GACvFX,EAASE,SAASU,cAAc,UACpCZ,EAAOQ,IAAM,GAAGJ,OAAOjB,GAAQiB,OAAOM,GACtC,IAAIG,EAAaX,SAASY,MAAQZ,SAASa,KAE3C,IAAKF,EACH,MAAM,IAAIG,MAAM,+EAIlB,OADAH,EAAWI,YAAYjB,GAChBA,CACR,CA4CgBkB,CAAa1B,IAGxBQ,EAAOmB,iBAAiB,QAAQ,WAC1BvB,OAAOC,OACTH,EAAQE,OAAOC,QAEfF,EAAO,IAAIqB,MAAM,2BAEpB,IACDhB,EAAOmB,iBAAiB,SAAS,WAC/BxB,EAAO,IAAIqB,MAAM,4BAClB,GAIF,CAHC,MAAOI,GAEP,YADAzB,EAAOyB,EAER,MAnCC1B,EAAQ,KAoCX,KA3CQJ,CA6CV,EACG+B,EAAa,SAAoBC,EAAaC,EAAMC,GACtD,GAAoB,OAAhBF,EACF,OAAO,KAGT,IAAIG,EAASH,EAAYI,WAAMC,EAAWJ,GAE1C,OArEoB,SAAyBE,EAAQD,GAChDC,GAAWA,EAAOG,kBAIvBH,EAAOG,iBAAiB,CACtBC,KAAM,YACNC,QAAS,SACTN,UAAWA,GAEd,CA0DCO,CAAgBN,EAAQD,GACjBC,CACR,EAiBGO,GAAmB,EACnBC,EAAa,WACf,IAAK,IAAIC,EAAOC,UAAU7B,OAAQiB,EAAO,IAAIa,MAAMF,GAAOG,EAAO,EAAGA,EAAOH,EAAMG,IAC/Ed,EAAKc,GAAQF,UAAUE,GAGzBL,GAAmB,EACnB,IAAIR,EAAYc,KAAKC,MACrB,OAAOhD,EAAWL,GAAYsD,MAAK,SAAUlB,GAC3C,OAAOD,EAAWC,EAAaC,EAAMC,EACtC,GACF,EAEDS,EAAWQ,kBAAoB,SAAUjD,GACvC,GAAIwC,EACF,MAAM,IAAIhB,MAAM,8DAGlB9B,EAjCuB,SAA4BM,GACnD,IAAIkD,EAAe,mHAAmHtC,OAAOuC,KAAKC,UAAUpD,GAAS,MAErK,GAAe,OAAXA,GAAuC,WAApBZ,EAAQY,GAC7B,MAAM,IAAIwB,MAAM0B,GAGlB,GAAmC,IAA/BG,OAAOC,KAAKtD,GAAQc,QAAuD,kBAAhCd,EAAOmB,qBACpD,OAAOnB,EAGT,MAAM,IAAIwB,MAAM0B,EACjB,CAqBcK,CAAmBvD,EACjC,EAEDwD,EAAQf,WAAaA,gBCjKrBgB,EAAOD,QAAU,EAAjBC,oBCAA,IAAIrE,EAAUsE,EAAAA,KAAAA,QAEd,SAASC,IACP,aAGAF,EAAOD,QAAUG,EAAsB,WACrC,OAAOH,CACR,EAAEC,EAAOD,QAAQI,YAAa,EAAMH,EAAOD,QAAiB,QAAIC,EAAOD,QACxE,IAAIA,EAAU,CAAC,EACXK,EAAKR,OAAO5D,UACZqE,EAASD,EAAGE,eACZC,EAAU,mBAAqB1E,OAASA,OAAS,CAAC,EAClD2E,EAAiBD,EAAQzE,UAAY,aACrC2E,EAAsBF,EAAQG,eAAiB,kBAC/CC,EAAoBJ,EAAQK,aAAe,gBAE/C,SAASC,EAAOjF,EAAKkF,EAAKC,GACxB,OAAOnB,OAAOoB,eAAepF,EAAKkF,EAAK,CACrCC,MAAOA,EACPE,YAAY,EACZC,cAAc,EACdC,UAAU,IACRvF,EAAIkF,EACT,CAED,IACED,EAAO,CAAC,EAAG,GAKZ,CAJC,MAAOO,GACPP,EAAS,SAAgBjF,EAAKkF,EAAKC,GACjC,OAAOnF,EAAIkF,GAAOC,CACnB,CACF,CAED,SAASM,EAAKC,EAASC,EAASC,EAAMC,GACpC,IAAIC,EAAiBH,GAAWA,EAAQvF,qBAAqB2F,EAAYJ,EAAUI,EAC/EC,EAAYhC,OAAOiC,OAAOH,EAAe1F,WACzC8F,EAAU,IAAIC,EAAQN,GAAe,IACzC,OAAOG,EAAUI,QAAU,SAAUV,EAASE,EAAMM,GAClD,IAAIG,EAAQ,iBACZ,OAAO,SAAUC,EAAQC,GACvB,GAAI,cAAgBF,EAAO,MAAM,IAAIlE,MAAM,gCAE3C,GAAI,cAAgBkE,EAAO,CACzB,GAAI,UAAYC,EAAQ,MAAMC,EAC9B,MA4KC,CACLpB,WAAOrC,EACP0D,MAAM,EA7KH,CAED,IAAKN,EAAQI,OAASA,EAAQJ,EAAQK,IAAMA,IAAO,CACjD,IAAIE,EAAWP,EAAQO,SAEvB,GAAIA,EAAU,CACZ,IAAIC,EAAiBC,EAAoBF,EAAUP,GAEnD,GAAIQ,EAAgB,CAClB,GAAIA,IAAmBE,EAAkB,SACzC,OAAOF,CACR,CACF,CAED,GAAI,SAAWR,EAAQI,OAAQJ,EAAQW,KAAOX,EAAQY,MAAQZ,EAAQK,SAAS,GAAI,UAAYL,EAAQI,OAAQ,CAC7G,GAAI,mBAAqBD,EAAO,MAAMA,EAAQ,YAAaH,EAAQK,IACnEL,EAAQa,kBAAkBb,EAAQK,IACnC,KAAM,WAAaL,EAAQI,QAAUJ,EAAQc,OAAO,SAAUd,EAAQK,KACvEF,EAAQ,YACR,IAAIY,EAASC,EAASxB,EAASE,EAAMM,GAErC,GAAI,WAAae,EAAOE,KAAM,CAC5B,GAAId,EAAQH,EAAQM,KAAO,YAAc,iBAAkBS,EAAOV,MAAQK,EAAkB,SAC5F,MAAO,CACLzB,MAAO8B,EAAOV,IACdC,KAAMN,EAAQM,KAEjB,CAED,UAAYS,EAAOE,OAASd,EAAQ,YAAaH,EAAQI,OAAS,QAASJ,EAAQK,IAAMU,EAAOV,IACjG,CACF,CACF,CAxC0B,CAwCzBb,EAASE,EAAMM,GAAUF,CAC5B,CAED,SAASkB,EAASE,EAAIpH,EAAKuG,GACzB,IACE,MAAO,CACLY,KAAM,SACNZ,IAAKa,EAAGC,KAAKrH,EAAKuG,GAOrB,CALC,MAAOf,GACP,MAAO,CACL2B,KAAM,QACNZ,IAAKf,EAER,CACF,CAEDrB,EAAQsB,KAAOA,EACf,IAAImB,EAAmB,CAAC,EAExB,SAASb,IAAc,CAEvB,SAASuB,IAAsB,CAE/B,SAASC,IAA+B,CAExC,IAAIC,EAAoB,CAAC,EACzBvC,EAAOuC,EAAmB5C,GAAgB,WACxC,OAAO6C,IACR,IACD,IAAIC,EAAW1D,OAAO2D,eAClBC,EAA0BF,GAAYA,EAASA,EAASG,EAAO,MACnED,GAA2BA,IAA4BpD,GAAMC,EAAO4C,KAAKO,EAAyBhD,KAAoB4C,EAAoBI,GAC1I,IAAIE,EAAKP,EAA2BnH,UAAY2F,EAAU3F,UAAY4D,OAAOiC,OAAOuB,GAEpF,SAASO,EAAsB3H,GAC7B,CAAC,OAAQ,QAAS,UAAU4H,SAAQ,SAAU1B,GAC5CrB,EAAO7E,EAAWkG,GAAQ,SAAUC,GAClC,OAAOkB,KAAKrB,QAAQE,EAAQC,EAC7B,GACF,GACF,CAED,SAAS0B,EAAcjC,EAAWkC,GAChC,SAASC,EAAO7B,EAAQC,EAAK1F,EAASC,GACpC,IAAImG,EAASC,EAASlB,EAAUM,GAASN,EAAWO,GAEpD,GAAI,UAAYU,EAAOE,KAAM,CAC3B,IAAIiB,EAASnB,EAAOV,IAChBpB,EAAQiD,EAAOjD,MACnB,OAAOA,GAAS,UAAYpF,EAAQoF,IAAUV,EAAO4C,KAAKlC,EAAO,WAAa+C,EAAYrH,QAAQsE,EAAMkD,SAAS1E,MAAK,SAAUwB,GAC9HgD,EAAO,OAAQhD,EAAOtE,EAASC,EAChC,IAAE,SAAU0E,GACX2C,EAAO,QAAS3C,EAAK3E,EAASC,EAC/B,IAAIoH,EAAYrH,QAAQsE,GAAOxB,MAAK,SAAU2E,GAC7CF,EAAOjD,MAAQmD,EAAWzH,EAAQuH,EACnC,IAAE,SAAU7F,GACX,OAAO4F,EAAO,QAAS5F,EAAO1B,EAASC,EACxC,GACF,CAEDA,EAAOmG,EAAOV,IACf,CAED,IAAIgC,EAEJd,KAAKrB,QAAU,SAAUE,EAAQC,GAC/B,SAASiC,IACP,OAAO,IAAIN,GAAY,SAAUrH,EAASC,GACxCqH,EAAO7B,EAAQC,EAAK1F,EAASC,EAC9B,GACF,CAED,OAAOyH,EAAkBA,EAAkBA,EAAgB5E,KAAK6E,EAA4BA,GAA8BA,GAC3H,CACF,CAED,SAAS7B,EAAoBF,EAAUP,GACrC,IAAII,EAASG,EAASvG,SAASgG,EAAQI,QAEvC,QAAIxD,IAAcwD,EAAQ,CACxB,GAAIJ,EAAQO,SAAW,KAAM,UAAYP,EAAQI,OAAQ,CACvD,GAAIG,EAASvG,SAAT,SAAgCgG,EAAQI,OAAS,SAAUJ,EAAQK,SAAMzD,EAAW6D,EAAoBF,EAAUP,GAAU,UAAYA,EAAQI,QAAS,OAAOM,EACpKV,EAAQI,OAAS,QAASJ,EAAQK,IAAM,IAAIkC,UAAU,iDACvD,CAED,OAAO7B,CACR,CAED,IAAIK,EAASC,EAASZ,EAAQG,EAASvG,SAAUgG,EAAQK,KACzD,GAAI,UAAYU,EAAOE,KAAM,OAAOjB,EAAQI,OAAS,QAASJ,EAAQK,IAAMU,EAAOV,IAAKL,EAAQO,SAAW,KAAMG,EACjH,IAAI8B,EAAOzB,EAAOV,IAClB,OAAOmC,EAAOA,EAAKlC,MAAQN,EAAQO,EAASkC,YAAcD,EAAKvD,MAAOe,EAAQ0C,KAAOnC,EAASoC,QAAS,WAAa3C,EAAQI,SAAWJ,EAAQI,OAAS,OAAQJ,EAAQK,SAAMzD,GAAYoD,EAAQO,SAAW,KAAMG,GAAoB8B,GAAQxC,EAAQI,OAAS,QAASJ,EAAQK,IAAM,IAAIkC,UAAU,oCAAqCvC,EAAQO,SAAW,KAAMG,EACpW,CAED,SAASkC,EAAaC,GACpB,IAAIC,EAAQ,CACVC,OAAQF,EAAK,IAEf,KAAKA,IAASC,EAAME,SAAWH,EAAK,IAAK,KAAKA,IAASC,EAAMG,WAAaJ,EAAK,GAAIC,EAAMI,SAAWL,EAAK,IAAKtB,KAAK4B,WAAWC,KAAKN,EACpI,CAED,SAASO,EAAcP,GACrB,IAAI/B,EAAS+B,EAAMQ,YAAc,CAAC,EAClCvC,EAAOE,KAAO,gBAAiBF,EAAOV,IAAKyC,EAAMQ,WAAavC,CAC/D,CAED,SAASd,EAAQN,GACf4B,KAAK4B,WAAa,CAAC,CACjBJ,OAAQ,SACNpD,EAAYmC,QAAQc,EAAcrB,MAAOA,KAAKgC,OAAM,EACzD,CAED,SAAS5B,EAAO6B,GACd,GAAIA,EAAU,CACZ,IAAIC,EAAiBD,EAAS9E,GAC9B,GAAI+E,EAAgB,OAAOA,EAAetC,KAAKqC,GAC/C,GAAI,mBAAqBA,EAASd,KAAM,OAAOc,EAE/C,IAAKE,MAAMF,EAASjI,QAAS,CAC3B,IAAID,GAAK,EACLoH,EAAO,SAASA,IAClB,OAASpH,EAAIkI,EAASjI,QACpB,GAAIgD,EAAO4C,KAAKqC,EAAUlI,GAAI,OAAOoH,EAAKzD,MAAQuE,EAASlI,GAAIoH,EAAKpC,MAAO,EAAIoC,EAGjF,OAAOA,EAAKzD,WAAQrC,EAAW8F,EAAKpC,MAAO,EAAIoC,CAChD,EAED,OAAOA,EAAKA,KAAOA,CACpB,CACF,CAED,MAAO,CACLA,KAAMiB,EAET,CAED,SAASA,IACP,MAAO,CACL1E,WAAOrC,EACP0D,MAAM,EAET,CAED,OAAOc,EAAkBlH,UAAYmH,EAA4BtC,EAAO6C,EAAI,cAAeP,GAA6BtC,EAAOsC,EAA4B,cAAeD,GAAoBA,EAAkBwC,YAAc7E,EAAOsC,EAA4BxC,EAAmB,qBAAsBZ,EAAQ4F,oBAAsB,SAAUC,GAChV,IAAIC,EAAO,mBAAqBD,GAAUA,EAAO7J,YACjD,QAAS8J,IAASA,IAAS3C,GAAqB,uBAAyB2C,EAAKH,aAAeG,EAAKjH,MACnG,EAAEmB,EAAQ+F,KAAO,SAAUF,GAC1B,OAAOhG,OAAOmG,eAAiBnG,OAAOmG,eAAeH,EAAQzC,IAA+ByC,EAAOI,UAAY7C,EAA4BtC,EAAO+E,EAAQjF,EAAmB,sBAAuBiF,EAAO5J,UAAY4D,OAAOiC,OAAO6B,GAAKkC,CAC3O,EAAE7F,EAAQkG,MAAQ,SAAU9D,GAC3B,MAAO,CACL8B,QAAS9B,EAEZ,EAAEwB,EAAsBE,EAAc7H,WAAY6E,EAAOgD,EAAc7H,UAAWyE,GAAqB,WACtG,OAAO4C,IACR,IAAGtD,EAAQ8D,cAAgBA,EAAe9D,EAAQmG,MAAQ,SAAU5E,EAASC,EAASC,EAAMC,EAAaqC,QACxG,IAAWA,IAAgBA,EAActH,SACzC,IAAI2J,EAAO,IAAItC,EAAcxC,EAAKC,EAASC,EAASC,EAAMC,GAAcqC,GACxE,OAAO/D,EAAQ4F,oBAAoBpE,GAAW4E,EAAOA,EAAK3B,OAAOjF,MAAK,SAAUyE,GAC9E,OAAOA,EAAO5B,KAAO4B,EAAOjD,MAAQoF,EAAK3B,MAC1C,GACF,EAAEb,EAAsBD,GAAK7C,EAAO6C,EAAI/C,EAAmB,aAAcE,EAAO6C,EAAIlD,GAAgB,WACnG,OAAO6C,IACR,IAAGxC,EAAO6C,EAAI,YAAY,WACzB,MAAO,oBACR,IAAG3D,EAAQF,KAAO,SAAUuG,GAC3B,IAAIvG,EAAO,GAEX,IAAK,IAAIiB,KAAOsF,EACdvG,EAAKqF,KAAKpE,GAGZ,OAAOjB,EAAKwG,UAAW,SAAS7B,IAC9B,KAAO3E,EAAKxC,QAAS,CACnB,IAAIyD,EAAMjB,EAAKyG,MACf,GAAIxF,KAAOsF,EAAQ,OAAO5B,EAAKzD,MAAQD,EAAK0D,EAAKpC,MAAO,EAAIoC,CAC7D,CAED,OAAOA,EAAKpC,MAAO,EAAIoC,CACxB,CACF,EAAEzE,EAAQ0D,OAASA,EAAQ1B,EAAQ/F,UAAY,CAC9CD,YAAagG,EACbsD,MAAO,SAAekB,GACpB,GAAIlD,KAAKmD,KAAO,EAAGnD,KAAKmB,KAAO,EAAGnB,KAAKZ,KAAOY,KAAKX,WAAQhE,EAAW2E,KAAKjB,MAAO,EAAIiB,KAAKhB,SAAW,KAAMgB,KAAKnB,OAAS,OAAQmB,KAAKlB,SAAMzD,EAAW2E,KAAK4B,WAAWrB,QAAQuB,IAAiBoB,EAAe,IAAK,IAAI3H,KAAQyE,KAC/N,MAAQzE,EAAK6H,OAAO,IAAMpG,EAAO4C,KAAKI,KAAMzE,KAAU4G,OAAO5G,EAAK8H,MAAM,MAAQrD,KAAKzE,QAAQF,EAEhG,EACDiI,KAAM,WACJtD,KAAKjB,MAAO,EACZ,IAAIwE,EAAavD,KAAK4B,WAAW,GAAGG,WACpC,GAAI,UAAYwB,EAAW7D,KAAM,MAAM6D,EAAWzE,IAClD,OAAOkB,KAAKwD,IACb,EACDlE,kBAAmB,SAA2BmE,GAC5C,GAAIzD,KAAKjB,KAAM,MAAM0E,EACrB,IAAIhF,EAAUuB,KAEd,SAAS0D,EAAOC,EAAKC,GACnB,OAAOpE,EAAOE,KAAO,QAASF,EAAOV,IAAM2E,EAAWhF,EAAQ0C,KAAOwC,EAAKC,IAAWnF,EAAQI,OAAS,OAAQJ,EAAQK,SAAMzD,KAAcuI,CAC3I,CAED,IAAK,IAAI7J,EAAIiG,KAAK4B,WAAW5H,OAAS,EAAGD,GAAK,IAAKA,EAAG,CACpD,IAAIwH,EAAQvB,KAAK4B,WAAW7H,GACxByF,EAAS+B,EAAMQ,WACnB,GAAI,SAAWR,EAAMC,OAAQ,OAAOkC,EAAO,OAE3C,GAAInC,EAAMC,QAAUxB,KAAKmD,KAAM,CAC7B,IAAIU,EAAW7G,EAAO4C,KAAK2B,EAAO,YAC9BuC,EAAa9G,EAAO4C,KAAK2B,EAAO,cAEpC,GAAIsC,GAAYC,EAAY,CAC1B,GAAI9D,KAAKmD,KAAO5B,EAAME,SAAU,OAAOiC,EAAOnC,EAAME,UAAU,GAC9D,GAAIzB,KAAKmD,KAAO5B,EAAMG,WAAY,OAAOgC,EAAOnC,EAAMG,WACvD,MAAM,GAAImC,GACT,GAAI7D,KAAKmD,KAAO5B,EAAME,SAAU,OAAOiC,EAAOnC,EAAME,UAAU,OACzD,CACL,IAAKqC,EAAY,MAAM,IAAIpJ,MAAM,0CACjC,GAAIsF,KAAKmD,KAAO5B,EAAMG,WAAY,OAAOgC,EAAOnC,EAAMG,WACvD,CACF,CACF,CACF,EACDnC,OAAQ,SAAgBG,EAAMZ,GAC5B,IAAK,IAAI/E,EAAIiG,KAAK4B,WAAW5H,OAAS,EAAGD,GAAK,IAAKA,EAAG,CACpD,IAAIwH,EAAQvB,KAAK4B,WAAW7H,GAE5B,GAAIwH,EAAMC,QAAUxB,KAAKmD,MAAQnG,EAAO4C,KAAK2B,EAAO,eAAiBvB,KAAKmD,KAAO5B,EAAMG,WAAY,CACjG,IAAIqC,EAAexC,EACnB,KACD,CACF,CAEDwC,IAAiB,UAAYrE,GAAQ,aAAeA,IAASqE,EAAavC,QAAU1C,GAAOA,GAAOiF,EAAarC,aAAeqC,EAAe,MAC7I,IAAIvE,EAASuE,EAAeA,EAAahC,WAAa,CAAC,EACvD,OAAOvC,EAAOE,KAAOA,EAAMF,EAAOV,IAAMA,EAAKiF,GAAgB/D,KAAKnB,OAAS,OAAQmB,KAAKmB,KAAO4C,EAAarC,WAAYvC,GAAoBa,KAAKgE,SAASxE,EAC3J,EACDwE,SAAU,SAAkBxE,EAAQmC,GAClC,GAAI,UAAYnC,EAAOE,KAAM,MAAMF,EAAOV,IAC1C,MAAO,UAAYU,EAAOE,MAAQ,aAAeF,EAAOE,KAAOM,KAAKmB,KAAO3B,EAAOV,IAAM,WAAaU,EAAOE,MAAQM,KAAKwD,KAAOxD,KAAKlB,IAAMU,EAAOV,IAAKkB,KAAKnB,OAAS,SAAUmB,KAAKmB,KAAO,OAAS,WAAa3B,EAAOE,MAAQiC,IAAa3B,KAAKmB,KAAOQ,GAAWxC,CACrQ,EACD8E,OAAQ,SAAgBvC,GACtB,IAAK,IAAI3H,EAAIiG,KAAK4B,WAAW5H,OAAS,EAAGD,GAAK,IAAKA,EAAG,CACpD,IAAIwH,EAAQvB,KAAK4B,WAAW7H,GAC5B,GAAIwH,EAAMG,aAAeA,EAAY,OAAO1B,KAAKgE,SAASzC,EAAMQ,WAAYR,EAAMI,UAAWG,EAAcP,GAAQpC,CACpH,CACF,EACD,MAAS,SAAgBqC,GACvB,IAAK,IAAIzH,EAAIiG,KAAK4B,WAAW5H,OAAS,EAAGD,GAAK,IAAKA,EAAG,CACpD,IAAIwH,EAAQvB,KAAK4B,WAAW7H,GAE5B,GAAIwH,EAAMC,SAAWA,EAAQ,CAC3B,IAAIhC,EAAS+B,EAAMQ,WAEnB,GAAI,UAAYvC,EAAOE,KAAM,CAC3B,IAAIwE,EAAS1E,EAAOV,IACpBgD,EAAcP,EACf,CAED,OAAO2C,CACR,CACF,CAED,MAAM,IAAIxJ,MAAM,wBACjB,EACDyJ,cAAe,SAAuBlC,EAAUf,EAAYE,GAC1D,OAAOpB,KAAKhB,SAAW,CACrBvG,SAAU2H,EAAO6B,GACjBf,WAAYA,EACZE,QAASA,GACR,SAAWpB,KAAKnB,SAAWmB,KAAKlB,SAAMzD,GAAY8D,CACtD,GACAzC,CACJ,CAEDC,EAAOD,QAAUG,EAAqBF,EAAOD,QAAQI,YAAa,EAAMH,EAAOD,QAAiB,QAAIC,EAAOD,iBCjW3G,SAASpE,EAAQC,GAGf,OAAQoE,EAAOD,QAAUpE,EAAU,mBAAqBE,QAAU,iBAAmBA,OAAOC,SAAW,SAAUF,GAC/G,cAAcA,CACf,EAAG,SAAUA,GACZ,OAAOA,GAAO,mBAAqBC,QAAUD,EAAIG,cAAgBF,QAAUD,IAAQC,OAAOG,UAAY,gBAAkBJ,CACzH,EAAEoE,EAAOD,QAAQI,YAAa,EAAMH,EAAOD,QAAiB,QAAIC,EAAOD,QAAUpE,EAAQC,EAC3F,CAEDoE,EAAOD,QAAUpE,EAASqE,EAAOD,QAAQI,YAAa,EAAMH,EAAOD,QAAiB,QAAIC,EAAOD,uBCR/F,IAAI0H,EAAUxH,EAAQ,IAARA,GACdD,EAAOD,QAAU0H,EAGjB,IACEC,mBAAqBD,CAOtB,CANC,MAAOE,GACmB,iBAAfC,WACTA,WAAWF,mBAAqBD,EAEhCI,SAAS,IAAK,yBAAdA,CAAwCJ,EAE3C,ICbGK,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBtJ,IAAjBuJ,EACH,OAAOA,EAAalI,QAGrB,IAAIC,EAAS8H,EAAyBE,GAAY,CAGjDjI,QAAS,CAAC,GAOX,OAHAmI,EAAoBF,GAAUhI,EAAQA,EAAOD,QAASgI,GAG/C/H,EAAOD,OACf,CCrBAgI,EAAoBI,EAAKnI,IACxB,IAAIoI,EAASpI,GAAUA,EAAOG,WAC7B,IAAOH,EAAiB,QACxB,IAAM,EAEP,OADA+H,EAAoBM,EAAED,EAAQ,CAAEE,EAAGF,IAC5BA,CAAM,ECLdL,EAAoBM,EAAI,CAACtI,EAASwI,KACjC,IAAI,IAAIzH,KAAOyH,EACXR,EAAoBS,EAAED,EAAYzH,KAASiH,EAAoBS,EAAEzI,EAASe,IAC5ElB,OAAOoB,eAAejB,EAASe,EAAK,CAAEG,YAAY,EAAMwH,IAAKF,EAAWzH,IAE1E,ECNDiH,EAAoBS,EAAI,CAAC5M,EAAK8M,IAAU9I,OAAO5D,UAAUsE,eAAe2C,KAAKrH,EAAK8M,GCClFX,EAAoBY,EAAK5I,IACH,oBAAXlE,QAA0BA,OAAO+E,aAC1ChB,OAAOoB,eAAejB,EAASlE,OAAO+E,YAAa,CAAEG,MAAO,WAE7DnB,OAAOoB,eAAejB,EAAS,aAAc,CAAEgB,OAAO,GAAO,8BCL/C,SAAS6H,IActB,OAbAA,EAAWhJ,OAAOiJ,OAASjJ,OAAOiJ,OAAOC,OAAS,SAAUC,GAC1D,IAAK,IAAI3L,EAAI,EAAGA,EAAI8B,UAAU7B,OAAQD,IAAK,CACzC,IAAI4L,EAAS9J,UAAU9B,GAEvB,IAAK,IAAI0D,KAAOkI,EACVpJ,OAAO5D,UAAUsE,eAAe2C,KAAK+F,EAAQlI,KAC/CiI,EAAOjI,GAAOkI,EAAOlI,GAG1B,CAED,OAAOiI,CACR,EACMH,EAASnK,MAAM4E,KAAMnE,UAC7B,CCfD,SAAS+J,EAAmBC,EAAKzM,EAASC,EAAQyM,EAAOC,EAAQtI,EAAKqB,GACpE,IACE,IAAImC,EAAO4E,EAAIpI,GAAKqB,GAChBpB,EAAQuD,EAAKvD,KAIlB,CAHC,MAAO5C,GAEP,YADAzB,EAAOyB,EAER,CAEGmG,EAAKlC,KACP3F,EAAQsE,GAERvE,QAAQC,QAAQsE,GAAOxB,KAAK4J,EAAOC,EAEtC,CAEc,SAASC,EAAkBrG,GACxC,OAAO,WACL,IAAIxB,EAAO6B,KACP/E,EAAOY,UACX,OAAO,IAAI1C,SAAQ,SAAUC,EAASC,GACpC,IAAIwM,EAAMlG,EAAGvE,MAAM+C,EAAMlD,GAEzB,SAAS6K,EAAMpI,GACbkI,EAAmBC,EAAKzM,EAASC,EAAQyM,EAAOC,EAAQ,OAAQrI,EACjE,CAED,SAASqI,EAAOhI,GACd6H,EAAmBC,EAAKzM,EAASC,EAAQyM,EAAOC,EAAQ,QAAShI,EAClE,CAED+H,OAAMzK,EACP,GACF,CACF,mDClCD,MAAM,EAA+B4K,OAAOC,KAAKC,OAAO,0BCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,iBCAlD,IAAiCF,OAAOG,WAAW,kBAAkB,CAAC,GAAU,OAAG,CAAC,GAAG,mCCA7F,MAAM,IAAiCH,OAAOG,WAAW,kBAAkB,CAAC,GAAU,OAAG,CAAC,GAAG,4CCA7F,MAAM,EAA+BH,OAAOC,KAAKC,OAAO,yCCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,yCCAzC,SAASE,EAAgBlB,EAAGmB,GAKzC,OAJAD,EAAkB9J,OAAOmG,eAAiBnG,OAAOmG,eAAe+C,OAAS,SAAyBN,EAAGmB,GAEnG,OADAnB,EAAExC,UAAY2D,EACPnB,CACR,EACMkB,EAAgBlB,EAAGmB,EAC3B,CCND,MAAM,EAA+BL,OAAOC,KAAKC,OAAO,+BCMnCI,EAAAA,SAAAA,GCLN,IAAwBC,EAAUC,oDAAAA,KAAVD,KAC5B7N,UAAY4D,OAAOiC,OAAOiI,EAAW9N,WAC9C6N,EAAS7N,UAAUD,YAAc8N,EACjC9D,EAAe8D,EAAUC,8BDGvBC,UAAA,WACI,MAAO,4BACV,IAEDC,MAAA,WACI,MAAO,EACV,IAEDC,QAAA,WACI,OAAOC,EAAE,SAAU,CACf3M,IAAK8F,KAAK8G,MAAMC,IAChBC,MAAO,IACPC,OAAQ,KAEf,IAfgBV,OAAoBW,IEJ5BC,EAAQ,CACjB,yBAA0BZ,WCE1Ba,EAA0B,KAEf,aAAf,iEAAe,iFACNA,EADM,iCAEUzL,EAAAA,EAAAA,YAAW0L,IAAAA,MAAAA,UAAoB,iCAFzC,UAEPD,EAFO,6BAMG,IAAI1M,MAAM,4BANb,gCAUJ0M,GAVI,kECQfC,IAAAA,aAAAA,IAAqB,2BAA2B,WAC5CC,IAAAA,UAAAA,8BAAqD,WAAqB,MAEtE,OAAID,IAAAA,MAAAA,UAAoB,mCAMhB,SAAArH,KAAK8G,MAAMS,WAAX,IAAiBC,iBAAkB,GAAK,CACnD,EAEDF,IAAAA,UAAAA,4BAAmD,WAG/C,QAASD,IAAAA,MAAAA,UAAoB,+BAChC,EAEDC,IAAAA,UAAAA,6BAAoD,WAChD,OAAO,CACV,EAEDA,IAAAA,UAAAA,2BAAkD,WAC9C,OAAO,CACV,EAEDA,IAAAA,UAAAA,mBAA0C,WACtC,QAASD,IAAAA,MAAAA,UAAoB,yBAChC,EAEDC,IAAAA,UAAAA,2BAAkD,SAAUG,GAA+C,WAEvG,YAFuG,IAA/CA,IAAAA,GAAyB,GAE1EJ,IAAAA,QAAiB,CACpBxI,OAAQ,OACRkI,IAAKM,IAAAA,MAAAA,UAAoB,UAAY,kCACrC5M,KAAM,CACFgN,cAAAA,GAEJC,aAAc1H,KAAK2H,6BACpBzL,KAPI,6BAOC,WAAM0L,GAAN,iEACJ,EAAKC,mBAAqBD,EAASE,cACnCjB,EAAEkB,SAFE,2CAPD,sDAWV,EAEDT,IAAAA,UAAAA,2BAAkD,SAAUU,GACxDA,EAAMC,iBACNjI,KAAKkI,iBAAmB,SACxBrB,EAAEkB,SAEFV,IAAAA,QAA6B,CACzBxI,OAAQ,OACRkI,IAAKM,IAAAA,MAAAA,UAAoB,UAAY,mCACrCK,aAAc1H,KAAK2H,6BACpBzL,MAAK,SAAA0L,GACJtO,OAAO6O,SAASC,KAAOR,EAASb,GACnC,IAND,MAMS/G,KAAKqI,kBAAkB5C,KAAKzF,MACxC,EAEDsH,IAAAA,UAAAA,6BAAA,6BAAoD,WAAgBU,GAAhB,kFAChDA,EAAMC,iBAGNjI,KAAKkI,iBAAmB,WAJwB,SAM1ClI,KAAKsI,4BAA2B,GANU,UAS3CtI,KAAK6H,mBATsC,uBAU5C7H,KAAKkI,iBAAmB,KACxBrB,EAAEkB,SAX0C,2CAe3BpM,IAf2B,WAe1CR,EAf0C,kBAoBxC6E,KAAKuI,qBApBmC,kCAqBvBpN,EAAOqN,mBAAmBxI,KAAK6H,mBAAqB,CACjEY,eAAgB,CAACC,KAAM1I,KAAK2I,0BAC5BC,WAAYvB,IAAAA,MAAAA,UAAoB,WAAa,oCAC9C,CAACwB,eAAe,IAxBqB,QAqBxCjB,EArBwC,kCA0BlCkB,EAAwB,CAC1BC,SAAU/I,KAAKgJ,sBACfC,cAAe,CACXL,WAAYvB,IAAAA,MAAAA,UAAoB,WAAa,+BAMjDA,IAAAA,MAAAA,UAAoB,gCAnCgB,kCAoCnBlM,EAAO+N,eAAP,KACVJ,EADU,CAEbK,SAAU,YAtCsB,QAoCpCvB,EApCoC,gDAyCnBzM,EAAO+N,eAAP,KACVJ,EADU,CAEbK,SAAU,iBA3CsB,QAyCpCvB,EAzCoC,wEAiD5CwB,MAAM,EAAD,IAjDuC,aAsDhDpJ,KAAKqJ,qBAAqBzB,GAtDsB,2DAApD,uDAyDA0B,EAAAA,EAAAA,QAAOhC,IAAAA,UAAsB,UAAU,WACnCtH,KAAKuJ,2BAA4B,EACjCvJ,KAAKwJ,uBAAwB,EAC7BxJ,KAAKkI,iBAAmB,KACxBlI,KAAK6H,mBAAqB,KAC1B7H,KAAKgJ,sBAAwB,KAC7BhJ,KAAKyJ,qBAAuB,KAC5BzJ,KAAK2I,yBAA2B,KAChC3I,KAAK0J,qBAAuB,KAC5B1J,KAAK2J,kCAAoC,IAC5C,KAEDL,EAAAA,EAAAA,QAAOhC,IAAAA,UAAsB,YAAY,WAAY,WACjDtH,KAAK4J,2BAAL,6BAAkC,WAAO5B,GAAP,0EACX,gCAAfA,EAAM6B,OAA0C,EAAKhC,mBAD3B,uBAE1BR,IAAAA,MAAAA,QAF0B,SAII1L,IAJJ,8BAIkBmO,sBAAsB,EAAKjC,oBAJ7C,OAIpBD,EAJoB,OAM1B,EAAKyB,qBAAqBzB,GAAU,GANV,2CAAlC,kCAAA5H,KAAA,eAUA1G,OAAOuB,iBAAiB,UAAWmF,KAAK4J,4BAA4B,EACvE,KAEDN,EAAAA,EAAAA,QAAOhC,IAAAA,UAAsB,YAAY,WACrChO,OAAOyQ,oBAAoB,UAAW/J,KAAK4J,2BAC9C,KAEDN,EAAAA,EAAAA,QAAOhC,IAAAA,UAAsB,yBAAyB,SAAU0C,GAAO,WACnE,GAAIhK,KAAKiK,8BAA+B,CACpC,IAAMC,EAAoC,WAA1BlK,KAAKkI,iBACrB8B,EAAMG,IAAI,kBAAmBC,IAAAA,UAAiB,CAC1C1D,UAAW,yBACX2D,QAASrK,KAAKsK,2BAA2B7E,KAAKzF,MAC9CuK,SAAUvK,KAAKwK,iBACfN,QAAAA,EACAO,KAAM,iBACPpD,IAAAA,WAAAA,MAAqB,oDAAsD6C,EAAU,UAAY,MACvG,CAED,GAAIlK,KAAK2J,kCAAmC,CACxC,IAAMe,EAAmB1K,KAAK2K,4BAK1BD,EAAiBE,SAAW5K,KAAK6K,gCACjC7K,KAAK0J,qBAAsBoB,OAAO,CAC9BC,MAAOL,IAIfV,EAAMG,IAAI,SAAUtD,EAAE,oCAAqC,CACvDmE,SAAU,WACN,EAAKrB,kCAAmCsB,MAAM,oCACjD,IAER,CACJ,KAED3B,EAAAA,EAAAA,QAAOhC,IAAAA,UAAsB,uBAAuB,SAAU0C,GAAO,WAiBjE,GAhBIhK,KAAKyJ,sBACLO,EAAMG,IAAI,SAAUtD,EAAE,6BAA8B,CAChDmE,SAAU,WACN,EAAKvB,qBAAsBwB,MAAM,6BACpC,KAILjL,KAAK2I,0BACLqB,EAAMG,IAAI,cAAetD,EAAE,kCAAmC,CAC1DmE,SAAU,WACN,EAAKrC,yBAA0BsC,MAAM,kCACxC,KAILjL,KAAKyJ,sBAAwBzJ,KAAK2I,yBAA0B,CAC5D,IAAMuB,EAAoC,aAA1BlK,KAAKkI,iBAErB8B,EAAMG,IAAI,gBAAiBC,IAAAA,UAAiB,CACxC1D,UAAW,yBACX2D,QAASrK,KAAKkL,6BAA6BzF,KAAKzF,MAChDuK,SAAUvK,KAAKwK,iBACfN,QAAAA,GACD7C,IAAAA,WAAAA,MAAqB,sDAAwD6C,EAAU,UAAY,MACzG,CACJ,IAED5C,IAAAA,UAAAA,qBAAA,6BAA4C,WAAkCM,EAAwDuD,GAA1F,qFAA0FA,IAAAA,GAAuB,GAGpJvD,EAAS9M,MAH0B,qBAIhC8M,EAASwD,eAAiBxD,EAASwD,cAAcC,aAAezD,EAASwD,cAAcC,YAAYC,iBAJnE,uBAKhCjE,IAAAA,MAAAA,KAAed,EAAa,CACxBQ,IAAKa,EAASwD,cAAcC,YAAYC,gBAAgBvE,MAN5B,iCAYpC/G,KAAKkI,iBAAmB,WACxBrB,EAAEkB,SAEF/H,KAAKuL,YAAY,CACbC,eAAe,IAhBiB,6BAsBjC1Q,EAAS8M,EAAT9M,MAKFqQ,GAA8B,0BAAfrQ,EAAM4E,MAAmD,oCAAf5E,EAAM2Q,KA3B5B,kCA4BN9P,IA5BM,gCA4BQmO,sBAAsB9J,KAAK6H,oBA5BnC,eA4B9BD,EA5B8B,OA8BpC5H,KAAKqJ,qBAAqBzB,GAAU,GA9BA,2BAqCxCP,IAAAA,OAAAA,KAAgB,CACR3H,KAAM,SACS,eAAf5E,EAAM4E,MAAwC,qBAAf5E,EAAM4E,KACrC5E,EAAM4Q,QACNrE,IAAAA,WAAAA,MAAqB,qEAG7BrH,KAAKkI,iBAAmB,KACxBrB,EAAEkB,SA7CsC,iDAA5C,2DAgDA4D,EAAAA,EAAAA,UAASrE,IAAAA,UAAsB,mBAAmB,SAAUsE,GACxD,QAAI5L,KAAKwJ,uBAIFoC,GACV,KAEDD,EAAAA,EAAAA,UAASrE,IAAAA,UAAsB,yBAAyB,SAAUsE,GAG9D,OAAIvE,IAAAA,MAAAA,UAAoB,2BAA6BrH,KAAK6L,6BAC/CxE,IAAAA,WAAAA,MAAqB,4DAGzBuE,GACV,KAEDD,EAAAA,EAAAA,UAASrE,IAAAA,UAAsB,qBAAqB,SAAUsE,GAG1D,OAFA5L,KAAKkI,iBAAmB,KAEjB0D,GACV,KAEDD,EAAAA,EAAAA,UAASrE,IAAAA,UAAsB,gBAAgB,SAAUsE,GACrD,QAAI5L,KAAKkI,kBAIF0D,GACV,IAEDtE,IAAAA,UAAAA,yBAAgD,WAAY,WAExD,IAAItH,KAAKuJ,4BAA6BvJ,KAAA,SAKtC,GAAKA,KAAK8L,gCAAV,CAMA9L,KAAKuJ,2BAA4B,EAEjC,IAAMwC,EAAyE,CAACpQ,KAG5EqE,KAAK6L,8BACLE,EAAgClK,KAAK7B,KAAKsI,8BAG9CnP,QAAQ6S,IAAID,GAAiC7P,MAAK,YAAc,IAAZf,EAAY,KAW5D,GAVA,EAAK6N,sBAAwB7N,EAAO4N,SAAS,CAACkD,aAAc,EAAKpE,yBAAsBxM,IAEnF,EAAKwQ,+BACD,EAAKtD,qBACL,EAAKI,yBAA2B,EAAKK,sBAAsBxK,OAAO,QAElE,EAAKiL,qBAAuB,EAAKT,sBAAsBxK,OAAO,YAIlE,EAAK0N,+BAAgC,CACrC,IAAMC,EAAwB,EAAKC,8BAGnC,EAAKvB,+BAAiCsB,EAAsBpB,MAAMH,OAElE,EAAKlB,qBAAuBvO,EAAOkR,eAAeF,GAElD,EAAKzC,qBAAqB4C,iBAAiBpQ,MAAK,SAAAyE,GACxCA,IACA,EAAKgJ,kCAAoC,EAAKX,sBAAuBxK,OAAO,uBAAwB,CAChG6N,eAAgB,EAAK3C,uBAGzB,EAAKA,qBAAsB6C,GAAG,gBAA9B,6BAA+C,WAAOC,GAAP,uFAGrC,EAAKlE,4BAA2B,GAHK,UAMtC,EAAKT,mBANiC,iEAWpB1M,EAAOqN,mBAAmB,EAAKX,mBAAoB,CACtEY,eAAgB+D,EAAGC,cAAcC,IAClC,CAAC7D,eAAe,IAbwB,OAWrCjB,EAXqC,OAe3C,EAAKyB,qBAAqBzB,GAfiB,2CAA/C,kCAAA5H,KAAA,iBAoBJ,EAAKwJ,uBAAwB,EAC7B3C,EAAEkB,QACL,GACJ,MAEG,EAAKyB,uBAAwB,EAC7B3C,EAAEkB,QAET,GAhEA,MAHG/H,KAAKwJ,uBAAwB,CAoEpC,GAEDF,EAAAA,EAAAA,QAAOhC,IAAAA,UAAsB,mBAAmB,WAC5CtH,KAAK2M,2BAEiB,qBAAlB3M,KAAA,WACAqH,IAAAA,OAAAA,KAAgBA,IAAAA,WAAAA,MAAqB,6DACrCrH,KAAK4M,iBAGa,WAAlB5M,KAAA,WACIA,KAAKiK,+BAAiCjK,KAAK8L,gCAG3C9L,KAAKuL,YAAY,CACbC,eAAe,IAKnBxL,KAAK4M,gBAGhB,KAEDtD,EAAAA,EAAAA,QAAOhC,IAAAA,UAAsB,kBAAmBA,IAAAA,UAAAA,0BAEhDA,IAAAA,UAAAA,4BAAmD,WAC/C,MAAO,CACHuF,QAAS,KACTC,SAAU,MACV/B,MAAO/K,KAAK2K,4BACZoC,kBAAkB,EAClBC,mBAAmB,EAE1B,EAED1F,IAAAA,UAAAA,0BAAiD,WAAY,MACzD,MAAO,CACH2F,MAAOC,IAAY7F,IAAAA,WAAAA,MAAqB,4DAExCuD,QAAQ,SAAA5K,KAAK8G,MAAMS,WAAX,IAAiB4F,0BAA2B,EAE3D,GAEDxB,EAAAA,EAAAA,UAASyB,IAAAA,UAA4B,SAAS,SAAUxB,GACpD,OAAK5L,KAAK8G,MAAMuG,QAAQxO,UAAY,IAAIyO,WAAW,WAE3CtN,KAAK8G,MAAMuG,QAAQxO,SAAU0O,SAAS,SAC/BlG,IAAAA,WAAAA,MAAqB,wDAG5BrH,KAAK8G,MAAMuG,QAAQxO,SAAU0O,SAAS,YAC/BlG,IAAAA,WAAAA,MAAqB,2DAGzBA,IAAAA,WAAAA,MAAqB,oDAGzBuE,GACV,GACJ","sources":["webpack://@flamarkt/balance/./node_modules/@stripe/stripe-js/dist/pure.js","webpack://@flamarkt/balance/./node_modules/@stripe/stripe-js/pure.js","webpack://@flamarkt/balance/./node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://@flamarkt/balance/./node_modules/@babel/runtime/helpers/typeof.js","webpack://@flamarkt/balance/./node_modules/@babel/runtime/regenerator/index.js","webpack://@flamarkt/balance/webpack/bootstrap","webpack://@flamarkt/balance/webpack/runtime/compat get default export","webpack://@flamarkt/balance/webpack/runtime/define property getters","webpack://@flamarkt/balance/webpack/runtime/hasOwnProperty shorthand","webpack://@flamarkt/balance/webpack/runtime/make namespace object","webpack://@flamarkt/balance/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@flamarkt/balance/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://@flamarkt/balance/external root \"flarum.core.compat['forum/app']\"","webpack://@flamarkt/balance/external root \"flarum.core.compat['common/extend']\"","webpack://@flamarkt/balance/external root \"((flarum.extensions['flamarkt-core']||{})['forum']||{})['layouts/CartLayout']\"","webpack://@flamarkt/balance/external root \"((flarum.extensions['flamarkt-core']||{})['forum']||{})['components/OrderFactPayment']\"","webpack://@flamarkt/balance/external root \"flarum.core.compat['common/components/Button']\"","webpack://@flamarkt/balance/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@flamarkt/balance/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flamarkt/balance/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@flamarkt/balance/./src/forum/components/IframeModal.ts","webpack://@flamarkt/balance/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flamarkt/balance/./src/forum/compat.ts","webpack://@flamarkt/balance/./src/forum/loadStripe.ts","webpack://@flamarkt/balance/./src/forum/index.ts"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nvar V3_URL = 'https://js.stripe.com/v3';\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(V3_URL, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!V3_URL_REGEX.test(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(V3_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"1.35.0\",\n    startTime: startTime\n  });\n};\n\nvar stripePromise = null;\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise !== null) {\n    return stripePromise;\n  }\n\n  stripePromise = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      }\n\n      script.addEventListener('load', function () {\n        if (window.Stripe) {\n          resolve(window.Stripe);\n        } else {\n          reject(new Error('Stripe.js not available'));\n        }\n      });\n      script.addEventListener('error', function () {\n        reject(new Error('Failed to load Stripe.js'));\n      });\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  });\n  return stripePromise;\n};\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n}; // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\nvar validateLoadParams = function validateLoadParams(params) {\n  var errorMessage = \"invalid load parameters; expected object of shape\\n\\n    {advancedFraudSignals: boolean}\\n\\nbut received\\n\\n    \".concat(JSON.stringify(params), \"\\n\");\n\n  if (params === null || _typeof(params) !== 'object') {\n    throw new Error(errorMessage);\n  }\n\n  if (Object.keys(params).length === 1 && typeof params.advancedFraudSignals === 'boolean') {\n    return params;\n  }\n\n  throw new Error(errorMessage);\n};\n\nvar loadParams;\nvar loadStripeCalled = false;\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadStripeCalled = true;\n  var startTime = Date.now();\n  return loadScript(loadParams).then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\nloadStripe.setLoadParameters = function (params) {\n  if (loadStripeCalled) {\n    throw new Error('You cannot change load parameters after calling loadStripe');\n  }\n\n  loadParams = validateLoadParams(params);\n};\n\nexports.loadStripe = loadStripe;\n","module.exports = require('./dist/pure.js');\n","var _typeof = require(\"./typeof.js\")[\"default\"];\n\nfunction _regeneratorRuntime() {\n  \"use strict\";\n  /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return exports;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var exports = {},\n      Op = Object.prototype,\n      hasOwn = Op.hasOwnProperty,\n      $Symbol = \"function\" == typeof Symbol ? Symbol : {},\n      iteratorSymbol = $Symbol.iterator || \"@@iterator\",\n      asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\",\n      toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    return Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), obj[key];\n  }\n\n  try {\n    define({}, \"\");\n  } catch (err) {\n    define = function define(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,\n        generator = Object.create(protoGenerator.prototype),\n        context = new Context(tryLocsList || []);\n    return generator._invoke = function (innerFn, self, context) {\n      var state = \"suspendedStart\";\n      return function (method, arg) {\n        if (\"executing\" === state) throw new Error(\"Generator is already running\");\n\n        if (\"completed\" === state) {\n          if (\"throw\" === method) throw arg;\n          return doneResult();\n        }\n\n        for (context.method = method, context.arg = arg;;) {\n          var delegate = context.delegate;\n\n          if (delegate) {\n            var delegateResult = maybeInvokeDelegate(delegate, context);\n\n            if (delegateResult) {\n              if (delegateResult === ContinueSentinel) continue;\n              return delegateResult;\n            }\n          }\n\n          if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) {\n            if (\"suspendedStart\" === state) throw state = \"completed\", context.arg;\n            context.dispatchException(context.arg);\n          } else \"return\" === context.method && context.abrupt(\"return\", context.arg);\n          state = \"executing\";\n          var record = tryCatch(innerFn, self, context);\n\n          if (\"normal\" === record.type) {\n            if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue;\n            return {\n              value: record.arg,\n              done: context.done\n            };\n          }\n\n          \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg);\n        }\n      };\n    }(innerFn, self, context), generator;\n  }\n\n  function tryCatch(fn, obj, arg) {\n    try {\n      return {\n        type: \"normal\",\n        arg: fn.call(obj, arg)\n      };\n    } catch (err) {\n      return {\n        type: \"throw\",\n        arg: err\n      };\n    }\n  }\n\n  exports.wrap = wrap;\n  var ContinueSentinel = {};\n\n  function Generator() {}\n\n  function GeneratorFunction() {}\n\n  function GeneratorFunctionPrototype() {}\n\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n  var getProto = Object.getPrototypeOf,\n      NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function (method) {\n      define(prototype, method, function (arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n\n      if (\"throw\" !== record.type) {\n        var result = record.arg,\n            value = result.value;\n        return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        }) : PromiseImpl.resolve(value).then(function (unwrapped) {\n          result.value = unwrapped, resolve(result);\n        }, function (error) {\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n\n      reject(record.arg);\n    }\n\n    var previousPromise;\n\n    this._invoke = function (method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function (resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n    };\n  }\n\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n\n    if (undefined === method) {\n      if (context.delegate = null, \"throw\" === context.method) {\n        if (delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method)) return ContinueSentinel;\n        context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n    if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel;\n    var info = record.arg;\n    return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel);\n  }\n\n  function pushTryEntry(locs) {\n    var entry = {\n      tryLoc: locs[0]\n    };\n    1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\", delete record.arg, entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);\n  }\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) return iteratorMethod.call(iterable);\n      if (\"function\" == typeof iterable.next) return iterable;\n\n      if (!isNaN(iterable.length)) {\n        var i = -1,\n            next = function next() {\n          for (; ++i < iterable.length;) {\n            if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;\n          }\n\n          return next.value = undefined, next.done = !0, next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    return {\n      next: doneResult\n    };\n  }\n\n  function doneResult() {\n    return {\n      value: undefined,\n      done: !0\n    };\n  }\n\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, define(Gp, \"constructor\", GeneratorFunctionPrototype), define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) {\n    var ctor = \"function\" == typeof genFun && genFun.constructor;\n    return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name));\n  }, exports.mark = function (genFun) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun;\n  }, exports.awrap = function (arg) {\n    return {\n      __await: arg\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    void 0 === PromiseImpl && (PromiseImpl = Promise);\n    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n    return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {\n      return result.done ? result.value : iter.next();\n    });\n  }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () {\n    return this;\n  }), define(Gp, \"toString\", function () {\n    return \"[object Generator]\";\n  }), exports.keys = function (object) {\n    var keys = [];\n\n    for (var key in object) {\n      keys.push(key);\n    }\n\n    return keys.reverse(), function next() {\n      for (; keys.length;) {\n        var key = keys.pop();\n        if (key in object) return next.value = key, next.done = !1, next;\n      }\n\n      return next.done = !0, next;\n    };\n  }, exports.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(skipTempReset) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) {\n        \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);\n      }\n    },\n    stop: function stop() {\n      this.done = !0;\n      var rootRecord = this.tryEntries[0].completion;\n      if (\"throw\" === rootRecord.type) throw rootRecord.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(exception) {\n      if (this.done) throw exception;\n      var context = this;\n\n      function handle(loc, caught) {\n        return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i],\n            record = entry.completion;\n        if (\"root\" === entry.tryLoc) return handle(\"end\");\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\"),\n              hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n          } else {\n            if (!hasFinally) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n\n        if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);\n      var record = finallyEntry ? finallyEntry.completion : {};\n      return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);\n    },\n    complete: function complete(record, afterLoc) {\n      if (\"throw\" === record.type) throw record.arg;\n      return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;\n    },\n    finish: function finish(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;\n      }\n    },\n    \"catch\": function _catch(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n\n          if (\"throw\" === record.type) {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n\n          return thrown;\n        }\n      }\n\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n      return this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel;\n    }\n  }, exports;\n}\n\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(obj);\n}\n\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['forum']||{})['layouts/CartLayout'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['forum']||{})['components/OrderFactPayment'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","import Modal, {IInternalModalAttrs} from 'flarum/common/components/Modal';\n\ninterface IframeModalAttrs extends IInternalModalAttrs {\n    url: string\n}\n\nexport default class IframeModal extends Modal<IframeModalAttrs> {\n    className(): string {\n        return 'FlamarktStripePaymentModal';\n    }\n\n    title() {\n        return '';\n    }\n\n    content() {\n        return m('iframe', {\n            src: this.attrs.url,\n            width: 600,\n            height: 400,\n        });\n    }\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import IframeModal from './components/IframeModal';\n\nexport const forum = {\n    'components/IframeModal': IframeModal,\n}\n","import {Stripe} from '@stripe/stripe-js';\nimport {loadStripe} from '@stripe/stripe-js/pure';\nimport app from 'flarum/forum/app';\n\n// confirmCardPayment requires the same instance of Stripe.js to be used between element creation and confirmation, so we'll store it here\nlet instance: Stripe | null = null;\n\nexport default async function (): Promise<Stripe> {\n    if (!instance) {\n        instance = await loadStripe(app.forum.attribute('flamarktStripePublishableKey'));\n\n        // Not sure why loadStripe is type-hinted as possible null while the example don't mention it\n        if (!instance) {\n            throw new Error('Stripe.js failed to load');\n        }\n    }\n\n    return instance;\n}\n","import {PaymentIntentResult, Stripe, StripeError} from '@stripe/stripe-js';\nimport app from 'flarum/forum/app';\nimport {extend, override} from 'flarum/common/extend';\nimport CartLayout from 'flamarkt/core/forum/layouts/CartLayout';\nimport OrderFactPayment from 'flamarkt/core/forum/components/OrderFactPayment';\nimport Button from 'flarum/common/components/Button';\nimport extractText from 'flarum/common/utils/extractText';\nimport {forum} from './compat';\nimport IframeModal from './components/IframeModal';\nimport loadStripe from './loadStripe';\n\nexport {\n    forum,\n};\n\napp.initializers.add('flamarkt-payment-stripe', () => {\n    CartLayout.prototype.stripeEmbeddedCheckoutEnabled = function (): boolean {\n        // Currently hard-coded to opposite of hosted checkout\n        if (app.forum.attribute('flamarktStripeHostedCheckout')) {\n            return false;\n        }\n\n        // Only enable when something is present in the cart\n        // Otherwise our code that generates the payment intent couldn't proceed anyway\n        return (this.attrs.cart?.productCount() || 0) > 0;\n    };\n\n    CartLayout.prototype.stripeHostedCheckoutEnabled = function (): boolean {\n        // We don't disable the hosted checkout on an empty cart as it wouldn't improve performance\n        // and the submit button is already disabled by Flamarkt if there are no products in the cart\n        return !!app.forum.attribute('flamarktStripeHostedCheckout');\n    };\n\n    CartLayout.prototype.stripeInstantPaymentsEnabled = function (): boolean {\n        return true;\n    };\n\n    CartLayout.prototype.stripeOtherPaymentsEnabled = function (): boolean {\n        return true;\n    };\n\n    CartLayout.prototype.stripeCardOnlyMode = function (): boolean {\n        return !!app.forum.attribute('flamarktStripeCardOnly');\n    };\n\n    CartLayout.prototype.stripeRetrieveClientSecret = function (commitToOrder: boolean = false): Promise<void> {\n        // TODO: show dedicated error message instead of native HTTP error if there's an error retrieving token\n        return app.request<any>({\n            method: 'POST',\n            url: app.forum.attribute('apiUrl') + '/flamarkt/stripe-payment-intent',\n            body: {\n                commitToOrder,\n            },\n            errorHandler: this.cartSubmissionErrorHandler,\n        }).then(async response => {\n            this.stripeClientSecret = response.client_secret;\n            m.redraw();\n        });\n    };\n\n    CartLayout.prototype.stripeSubmitHostedCheckout = function (event: Event): void {\n        event.preventDefault();\n        this.stripeSubmitting = 'hosted';\n        m.redraw();\n\n        app.request<{ url: string }>({\n            method: 'POST',\n            url: app.forum.attribute('apiUrl') + '/flamarkt/stripe-hosted-checkout',\n            errorHandler: this.cartSubmissionErrorHandler,\n        }).then(response => {\n            window.location.href = response.url;\n        }).catch(this.afterFailedSubmit.bind(this));\n    };\n\n    CartLayout.prototype.stripeSubmitEmbeddedCheckout = async function (event: Event): Promise<void> {\n        event.preventDefault();\n\n        // Do this at the very beginning, so it doesn't end up in the asynchronous part\n        this.stripeSubmitting = 'embedded';\n\n        await this.stripeRetrieveClientSecret(true);\n\n        // stripeRetrieveClientSecret() takes care of showing an error if necessary\n        if (!this.stripeClientSecret) {\n            this.stripeSubmitting = null;\n            m.redraw();\n            return;\n        }\n\n        const stripe = await loadStripe();\n\n        let response!: PaymentIntentResult | { error: StripeError };\n\n        try {\n            if (this.stripeCardOnlyMode()) {\n                response = await stripe.confirmCardPayment(this.stripeClientSecret!, {\n                    payment_method: {card: this.stripePaymentCardElement!},\n                    return_url: app.forum.attribute('baseUrl') + '/flamarkt/stripe-iframe-complete',\n                }, {handleActions: false});\n            } else {\n                const confirmPaymentOptions = {\n                    elements: this.stripePaymentElements!,\n                    confirmParams: {\n                        return_url: app.forum.attribute('baseUrl') + '/flamarkt/stripe-redirect',\n                    },\n                };\n\n                // use if block because otherwise Typescript just isn't happy with the typings on the options object if\n                // manipulated through a ternary operator\n                if (app.forum.attribute('flamarktStripeAlwaysRedirect')) {\n                    response = await stripe.confirmPayment({\n                        ...confirmPaymentOptions,\n                        redirect: 'always',\n                    });\n                } else {\n                    response = await stripe.confirmPayment({\n                        ...confirmPaymentOptions,\n                        redirect: 'if_required',\n                    });\n                }\n            }\n        } catch (error) {\n            // TODO: better message? what might happen here?\n            alert(error);\n\n            throw error;\n        }\n\n        this.stripeCompleteIntent(response);\n    };\n\n    extend(CartLayout.prototype, 'oninit', function () {\n        this.stripeEmbeddedInitialized = false;\n        this.stripeEmbeddedLoading = true;\n        this.stripeSubmitting = null;\n        this.stripeClientSecret = null;\n        this.stripePaymentElements = null;\n        this.stripePaymentElement = null;\n        this.stripePaymentCardElement = null;\n        this.stripePaymentRequest = null;\n        this.stripePaymentRequestButtonElement = null;\n    });\n\n    extend(CartLayout.prototype, 'oncreate', function () {\n        this.stripeMessageEventListener = async (event: MessageEvent) => {\n            if (event.data === '3DS-authentication-complete' && this.stripeClientSecret) {\n                app.modal.close();\n\n                const response = await (await loadStripe()).retrievePaymentIntent(this.stripeClientSecret);\n\n                this.stripeCompleteIntent(response, true);\n            }\n        };\n\n        window.addEventListener('message', this.stripeMessageEventListener, false);\n    });\n\n    extend(CartLayout.prototype, 'onremove', function () {\n        window.removeEventListener('message', this.stripeMessageEventListener);\n    });\n\n    extend(CartLayout.prototype, 'instantPaymentOptions', function (items) {\n        if (this.stripeHostedCheckoutEnabled()) {\n            const loading = this.stripeSubmitting === 'hosted';\n            items.add('stripe-checkout', Button.component({\n                className: 'Button Button--primary',\n                onclick: this.stripeSubmitHostedCheckout.bind(this),\n                disabled: this.submitDisabled(),\n                loading,\n                icon: 'fab fa-stripe', // Icon not visible with default Flarum styling for .Button--primary\n            }, app.translator.trans('flamarkt-payment-stripe.forum.cart.submit.hosted' + (loading ? 'Loading' : ''))));\n        }\n\n        if (this.stripePaymentRequestButtonElement) {\n            const totalInformation = this.stripePaymentRequestTotal();\n\n            // There's no good place to update this value as soon as it changes\n            // But having this code anywhere in the view, it should react quickly enough\n            // By placing it here we don't need additional conditions to check if the payment request is being used\n            if (totalInformation.amount !== this.stripePaymentRequestLastAmount) {\n                this.stripePaymentRequest!.update({\n                    total: totalInformation,\n                });\n            }\n\n            items.add('stripe', m('#js-stripe-payment-request-button', {\n                oncreate: () => {\n                    this.stripePaymentRequestButtonElement!.mount('#js-stripe-payment-request-button');\n                },\n            }));\n        }\n    });\n\n    extend(CartLayout.prototype, 'otherPaymentOptions', function (items) {\n        if (this.stripePaymentElement) {\n            items.add('stripe', m('#js-stripe-payment-element', {\n                oncreate: () => {\n                    this.stripePaymentElement!.mount('#js-stripe-payment-element');\n                },\n            }));\n        }\n\n        if (this.stripePaymentCardElement) {\n            items.add('stripe-card', m('#js-stripe-payment-card-element', {\n                oncreate: () => {\n                    this.stripePaymentCardElement!.mount('#js-stripe-payment-card-element');\n                },\n            }));\n        }\n\n        if (this.stripePaymentElement || this.stripePaymentCardElement) {\n            const loading = this.stripeSubmitting === 'embedded';\n\n            items.add('stripe-submit', Button.component({\n                className: 'Button Button--primary',\n                onclick: this.stripeSubmitEmbeddedCheckout.bind(this),\n                disabled: this.submitDisabled(),\n                loading,\n            }, app.translator.trans('flamarkt-payment-stripe.forum.cart.submit.embedded' + (loading ? 'Loading' : ''))));\n        }\n    });\n\n    CartLayout.prototype.stripeCompleteIntent = async function (this: CartLayout, response: PaymentIntentResult | { error: StripeError }, noRecursion: boolean = false) {\n        // When using confirmCardPayment, there might be no errors\n        // This will also be used by confirmPayment when a redirect isn't required\n        if (!response.error) {\n            if (response.paymentIntent && response.paymentIntent.next_action && response.paymentIntent.next_action.redirect_to_url) {\n                app.modal.show(IframeModal, {\n                    url: response.paymentIntent.next_action.redirect_to_url.url,\n                });\n\n                return;\n            }\n\n            this.stripeSubmitting = 'embedded';\n            m.redraw();\n\n            this.submitOrder({\n                payWithStripe: true,\n            });\n\n            return;\n        }\n\n        const {error} = response;\n\n        // This error can happen if we are back on the page after a failed iframe redirect\n        // We'll check the state of the intent again and finish the submission if necessary\n        // The noRecursion parameter prevents an infinite loop\n        if (!noRecursion && error.type === 'invalid_request_error' && error.code === 'payment_intent_unexpected_state') {\n            const response = await (await loadStripe()).retrievePaymentIntent(this.stripeClientSecret!);\n\n            this.stripeCompleteIntent(response, true);\n\n            return;\n        }\n\n        // TODO: show message next to card input instead of an alert\n        // This code should only execute if there was an error (user is already redirected otherwise)\n        app.alerts.show({\n                type: 'error',\n            }, (error.type === 'card_error' || error.type === 'validation_error') ?\n                error.message :\n                app.translator.trans('flamarkt-payment-stripe.forum.cart.alert.stripeConfirmationError')\n        );\n\n        this.stripeSubmitting = null;\n        m.redraw();\n    }\n\n    override(CartLayout.prototype, 'paymentsLoading', function (original: any) {\n        if (this.stripeEmbeddedLoading) {\n            return true;\n        }\n\n        return original();\n    });\n\n    override(CartLayout.prototype, 'instantPaymentOrLabel', function (original: any) {\n        // If Stripe is in use, it's very likely that the only \"other\" payment method is Stripe\n        // If cards are the only option, it makes sense to switch the label\n        if (app.forum.attribute('flamarktStripeCardOnly') && this.stripeOtherPaymentsEnabled()) {\n            return app.translator.trans('flamarkt-payment-stripe.forum.cart.payment.instantOrCard');\n        }\n\n        return original();\n    });\n\n    override(CartLayout.prototype, 'afterFailedSubmit', function (original: any) {\n        this.stripeSubmitting = null;\n\n        return original();\n    });\n\n    override(CartLayout.prototype, 'formDisabled', function (original: any) {\n        if (this.stripeSubmitting) {\n            return true;\n        }\n\n        return original();\n    });\n\n    CartLayout.prototype.initializeEmbeddedStripe = function () {\n        // We check whether already initialized because the method can be called from either onCartAvailable or onContinueReset, and one doesn't exclude the other\n        if (this.stripeEmbeddedInitialized || this.continue) {\n            return;\n        }\n\n        // We need to keep the \"loading\" value to true until this code runs because the value of the enabled state depends on the cart being available\n        if (!this.stripeEmbeddedCheckoutEnabled()) {\n            this.stripeEmbeddedLoading = false;\n\n            return;\n        }\n\n        this.stripeEmbeddedInitialized = true;\n\n        const promisesAsSoonAsCartIsAvailable: [Promise<Stripe>, ...Promise<void>[]] = [loadStripe()];\n\n        // The Stripe payment/card elements require the client secret at page load\n        if (this.stripeOtherPaymentsEnabled()) {\n            promisesAsSoonAsCartIsAvailable.push(this.stripeRetrieveClientSecret());\n        }\n\n        Promise.all(promisesAsSoonAsCartIsAvailable).then(([stripe]) => {\n            this.stripePaymentElements = stripe.elements({clientSecret: this.stripeClientSecret || undefined});\n\n            if (this.stripeOtherPaymentsEnabled()) {\n                if (this.stripeCardOnlyMode()) {\n                    this.stripePaymentCardElement = this.stripePaymentElements.create('card');\n                } else {\n                    this.stripePaymentElement = this.stripePaymentElements.create('payment');\n                }\n            }\n\n            if (this.stripeInstantPaymentsEnabled()) {\n                const paymentRequestOptions = this.stripePaymentRequestOptions();\n\n                // Save the value for reference in the view later\n                this.stripePaymentRequestLastAmount = paymentRequestOptions.total.amount;\n\n                this.stripePaymentRequest = stripe.paymentRequest(paymentRequestOptions);\n\n                this.stripePaymentRequest.canMakePayment().then(result => {\n                    if (result) {\n                        this.stripePaymentRequestButtonElement = this.stripePaymentElements!.create('paymentRequestButton', {\n                            paymentRequest: this.stripePaymentRequest!,\n                        });\n\n                        this.stripePaymentRequest!.on('paymentmethod', async (ev) => {\n                            // Even if the secret is already available, this ensures the intent is updated with\n                            // the latest cart amount before we proceed\n                            await this.stripeRetrieveClientSecret(true);\n\n                            // stripeRetrieveClientSecret() takes care of showing an error if necessary\n                            if (!this.stripeClientSecret) {\n                                return;\n                            }\n\n                            // Confirm the PaymentIntent without handling potential next actions (yet).\n                            const response = await stripe.confirmCardPayment(this.stripeClientSecret, {\n                                payment_method: ev.paymentMethod.id,\n                            }, {handleActions: false});\n\n                            this.stripeCompleteIntent(response);\n                        });\n                    }\n\n                    // If instant payments are enabled, wait until the check is done to mark loading complete\n                    this.stripeEmbeddedLoading = false;\n                    m.redraw();\n                });\n            } else {\n                // If instant payments are disabled, we can mount the card elements right away\n                this.stripeEmbeddedLoading = false;\n                m.redraw();\n            }\n        });\n    };\n\n    extend(CartLayout.prototype, 'onCartAvailable', function () {\n        this.initializeEmbeddedStripe();\n\n        if (this.continue === 'stripe-cancelled') {\n            app.alerts.show(app.translator.trans('flamarkt-payment-stripe.forum.cart.alert.stripeCancelled'));\n            this.resetContinue();\n        }\n\n        if (this.continue === 'stripe') {\n            if (this.stripeHostedCheckoutEnabled() || this.stripeEmbeddedCheckoutEnabled()) {\n                // Whether it's hosted or embedded method will be checked server-side\n                // No need to set one of the submitting boolean variables since the \"continuing\" mode is already locking the form\n                this.submitOrder({\n                    payWithStripe: true,\n                });\n            } else {\n                // Natively, Stripe will always be available but if an extension extends the enabled() methods to selectively\n                // disable Stripe on specific orders, we want to gracefully handle the \"continue\" flag anyway\n                this.resetContinue();\n            }\n        }\n    });\n\n    extend(CartLayout.prototype, 'onContinueReset', CartLayout.prototype.initializeEmbeddedStripe);\n\n    CartLayout.prototype.stripePaymentRequestOptions = function () {\n        return {\n            country: 'CH',\n            currency: 'chf',\n            total: this.stripePaymentRequestTotal(),\n            requestPayerName: true,\n            requestPayerEmail: false,\n        };\n    };\n\n    CartLayout.prototype.stripePaymentRequestTotal = function () {\n        return {\n            label: extractText(app.translator.trans('flamarkt-payment-stripe.forum.cart.paymentRequest.total')),\n            // TODO: update when cart is modified\n            amount: this.attrs.cart?.amountDueAfterPartial() || 0,\n        };\n    };\n\n    override(OrderFactPayment.prototype, 'label', function (original) {\n        if ((this.attrs.payment.method() || '').startsWith('stripe-')) {\n            // TODO: option to use icon\n            if (this.attrs.payment.method()!.endsWith('-hold')) {\n                return app.translator.trans('flamarkt-payment-stripe.forum.order.paymentLabelHold');\n            }\n\n            if (this.attrs.payment.method()!.endsWith('-release')) {\n                return app.translator.trans('flamarkt-payment-stripe.forum.order.paymentLabelRelease');\n            }\n\n            return app.translator.trans('flamarkt-payment-stripe.forum.order.paymentLabel');\n        }\n\n        return original();\n    });\n})\n;\n"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","loadParams","V3_URL","V3_URL_REGEX","EXISTING_SCRIPT_MESSAGE","stripePromise","loadScript","params","Promise","resolve","reject","window","Stripe","console","warn","script","scripts","document","querySelectorAll","concat","i","length","test","src","findScript","queryString","advancedFraudSignals","createElement","headOrBody","head","body","Error","appendChild","injectScript","addEventListener","error","initStripe","maybeStripe","args","startTime","stripe","apply","undefined","_registerWrapper","name","version","registerWrapper","loadStripeCalled","loadStripe","_len","arguments","Array","_key","Date","now","then","setLoadParameters","errorMessage","JSON","stringify","Object","keys","validateLoadParams","exports","module","require","_regeneratorRuntime","__esModule","Op","hasOwn","hasOwnProperty","$Symbol","iteratorSymbol","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","key","value","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","_invoke","state","method","arg","done","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","type","fn","call","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","AsyncIterator","PromiseImpl","invoke","result","__await","unwrapped","previousPromise","callInvokeWithMethodAndArg","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","doneResult","displayName","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","async","iter","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","d","a","definition","o","get","prop","r","_extends","assign","bind","target","source","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","flarum","core","compat","extensions","_setPrototypeOf","p","IframeModal","subClass","superClass","className","title","content","m","attrs","url","width","height","Modal","forum","instance","app","CartLayout","cart","productCount","commitToOrder","errorHandler","cartSubmissionErrorHandler","response","stripeClientSecret","client_secret","redraw","event","preventDefault","stripeSubmitting","location","href","afterFailedSubmit","stripeRetrieveClientSecret","stripeCardOnlyMode","confirmCardPayment","payment_method","card","stripePaymentCardElement","return_url","handleActions","confirmPaymentOptions","elements","stripePaymentElements","confirmParams","confirmPayment","redirect","alert","stripeCompleteIntent","extend","stripeEmbeddedInitialized","stripeEmbeddedLoading","stripePaymentElement","stripePaymentRequest","stripePaymentRequestButtonElement","stripeMessageEventListener","data","retrievePaymentIntent","removeEventListener","items","stripeHostedCheckoutEnabled","loading","add","Button","onclick","stripeSubmitHostedCheckout","disabled","submitDisabled","icon","totalInformation","stripePaymentRequestTotal","amount","stripePaymentRequestLastAmount","update","total","oncreate","mount","stripeSubmitEmbeddedCheckout","noRecursion","paymentIntent","next_action","redirect_to_url","submitOrder","payWithStripe","code","message","override","original","stripeOtherPaymentsEnabled","stripeEmbeddedCheckoutEnabled","promisesAsSoonAsCartIsAvailable","all","clientSecret","stripeInstantPaymentsEnabled","paymentRequestOptions","stripePaymentRequestOptions","paymentRequest","canMakePayment","on","ev","paymentMethod","id","initializeEmbeddedStripe","resetContinue","country","currency","requestPayerName","requestPayerEmail","label","extractText","amountDueAfterPartial","OrderFactPayment","payment","startsWith","endsWith"],"sourceRoot":""}