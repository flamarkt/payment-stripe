(()=>{var t={n:e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return t.d(a,{a}),a},d:(e,a)=>{for(var r in a)t.o(a,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:a[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e);const a=((flarum.extensions["flamarkt-backoffice"]||{}).backoffice||{}).app;var r=t.n(a);const n=flarum.core.compat["common/extend"],s=((flarum.extensions["flamarkt-core"]||{}).backoffice||{})["components/PaymentList"];var i=t.n(s);const o=flarum.core.compat["common/components/Button"];var l=t.n(o);r().initializers.add("flamarkt-payment-stripe",(function(){r().extensionData.for("flamarkt-payment-stripe").registerSetting({type:"text",setting:"flamarkt-payment-stripe.secretKey",label:r().translator.trans("flamarkt-payment-stripe.backoffice.settings.secretKey")}).registerSetting({type:"text",setting:"flamarkt-payment-stripe.publishableKey",label:r().translator.trans("flamarkt-payment-stripe.backoffice.settings.publishableKey")}).registerSetting({type:"switch",setting:"flamarkt-payment-stripe.hostedCheckout",label:r().translator.trans("flamarkt-payment-stripe.backoffice.settings.hostedCheckout"),help:r().translator.trans("flamarkt-payment-stripe.backoffice.settings.hostedCheckoutHelp")}).registerSetting({type:"switch",setting:"flamarkt-payment-stripe.alwaysRedirect",label:r().translator.trans("flamarkt-payment-stripe.backoffice.settings.alwaysRedirect"),help:r().translator.trans("flamarkt-payment-stripe.backoffice.settings.alwaysRedirectHelp")}).registerSetting({type:"switch",setting:"flamarkt-payment-stripe.cardOnly",label:r().translator.trans("flamarkt-payment-stripe.backoffice.settings.cardOnly"),help:r().translator.trans("flamarkt-payment-stripe.backoffice.settings.cardOnlyHelp")}).registerSetting({type:"switch",setting:"flamarkt-payment-stripe.captureLater",label:r().translator.trans("flamarkt-payment-stripe.backoffice.settings.captureLater"),help:r().translator.trans("flamarkt-payment-stripe.backoffice.settings.captureLaterHelp")}).registerSetting({type:"switch",setting:"flamarkt-payment-stripe.forceLocaleAuto",label:r().translator.trans("flamarkt-payment-stripe.backoffice.settings.forceLocaleAuto"),help:r().translator.trans("flamarkt-payment-stripe.backoffice.settings.forceLocaleAutoHelp")}).registerSetting({type:"switch",setting:"flamarkt-payment-stripe.applePayDomainAssociation",label:r().translator.trans("flamarkt-payment-stripe.backoffice.settings.applePayDomainAssociation"),help:r().translator.trans("flamarkt-payment-stripe.backoffice.settings.applePayDomainAssociationHelp")}),(0,n.extend)(i().prototype,"actions",(function(t,e){"stripe-intent-hold"===e.method()&&t.add("stripe-capture",l().component({icon:"fas fa-credit-card",className:"Button",onclick:function(){var t=r().store.all("flamarkt-orders").find((function(t){return(t.payments()||[]).some((function(t){return t===e}))}));if(t){var a=Math.pow(10,r().forum.attribute("priceDecimals")),n=prompt("Amount to capture",t.priceTotal()/a);""!==n&&null!==n&&r().request({method:"POST",url:r().forum.attribute("apiUrl")+"/flamarkt/stripe-capture",body:{paymentIntentId:e.identifier(),amount:Math.round(n*a)}}).then((function(){r().alerts.show({type:"success"},"Funds captured. Refresh page to see.")}))}else console.error("Could not find order payment belongs to")}},"Capture funds"))}))}))})(),module.exports=e})();
//# sourceMappingURL=backoffice.js.map